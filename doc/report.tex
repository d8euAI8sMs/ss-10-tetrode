\documentclass[12pt,a4paper]{article}
\usepackage{russ}
\usepackage[english,russian]{babel}
\usepackage{microtype}
\usepackage{csquotes}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtext}
\usepackage[notrig,italicdiff]{physics}
\usepackage{newfloat}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{subfig}
\geometry{left=1cm,right=1cm,top=2cm,bottom=2cm}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.PNG}
\graphicspath{{./img/}}
\captionsetup[figure]{justification=centering}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}
\DeclareCaptionLabelSeparator{dotseparator}{. }
\captionsetup{labelsep=dotseparator}
\hypersetup{
	colorlinks,
	citecolor=black,
	filecolor=black,
	linkcolor=black,
	urlcolor=black
}

\begin{document}

    \input{title}

    \tableofcontents

    \clearpage

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Введение}

        В данной работе будет продемонстрировано применение метода \enquote{частица-сетка} к задаче моделирования электронной лампы (тетрода). Будет описан собственно метод \enquote{частица-сетка}, а также метод конечных элементов в постановке Галеркина, с помощью которого рассчитывается распределение потенциала внутри лампы.

        В практической части будут приведены и проанализированы результаты моделирования конкретных конфигураций системы.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Постановка задачи}

        Построить модель тетрода методом частица-сетка и снять вольт-амперные характеристики лампы в разных режимах работы.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Теоретическая часть}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                        SUBSECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \subsection{Физическая модель}

        Тетрод~--- четырехэлектродная лампа, состоящая из катода, управляющей сетки, экранирующей сетки и анода. Назначение управляющей сетки~--- изменение анодного тока лампы небольшим по сравнению с анодным потенциалом. Экранирующая сетка экранирует катод и управляющую сетку от действия анода.

        Будем считать, что пространство лампы заполнено вакуумом, сетки сделаны из металла и являются идеальными проводниками.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                        SUBSECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \subsection{Математическая модель}

        Распределение потенциала в пространстве подчиняется уравнению Пуассона. Оно имеет вид:
        %
        \begin{equation}\label{eq:poisson_eq}
            \Delta\varphi(\vb{r})
                = - \frac{\rho(\vb{r})}{\varepsilon_0} ,
        \end{equation}
        %
        где $\rho(\vb{r})$~--- плотность заряда, $\varepsilon_0$~--- универсальная диэлектрическая постоянная.

        Перейдем к безразмерному виду уравнения, произведя замену переменных по правилу:
        %
        \begin{equation}
            \rho \mapsto \varepsilon_0 \rho.
        \end{equation}
        %
        Уравнение Пуассона (\autoref{eq:poisson_eq}) при этом примет вид:
        %
        \begin{equation}\label{eq:poisson_eq_dimless}
            \Delta\varphi(\vb{r}) = - \rho(\vb{r}),
        \end{equation}

        На внешней поверхности металла потенциал одинаков и определяется по теореме Гаусса:
        %
        \begin{equation}
            \oint\limits_{\partial\Omega} \vb{E} \dd{\vb{S}}
                = \int\limits_\Omega \rho \dd{\Omega}
                = q_\Omega ,
        \end{equation}
        %
        где $\Omega$~--- область пространства (в т.ч. многосвязная), занимаемая телом, $\partial\Omega$~--- внешняя граница этой области.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                        SUBSECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \subsection{Численная модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                     SUBSUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsubsection{Дискретная модель}

            В целях ухода от неизбежно возникающих краевых эффектов у границ сеток целесообразно рассматривать поток частиц лишь вблизи оси симметрии лампы. При этом также желательно иметь малое количество узлов дискретной сетки. Данные требования приводят к необходимости построения неравномерной сетки.

            Построим наиболее подходящую задаче сетку узлов и проведем триангуляцию Делоне. Область моделирования обозначим $D$, множество всех узлов сетки~--- $V = \qty{ v_i \ |\  v_i = (x_i, y_i) \in D }$, множество всех треугольников~--- $T$, множество всех треугольников, соседних к $i$-му узлу~--- $T_i \subseteq T$. Теми же буквами будем обозначать множества индексов узлов (треугольников), т.е. запись $i \in V$ эквивалентна записи $v_i \in V$.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                     SUBSUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsubsection{Метод \enquote{частица-сетка}}

            В то время как метод \enquote{частица-частица} для вычисления силы, действующей на данную частицу, требует вычисления суммарной силы со стороны всех остальных частиц, метод \enquote{частица-сетка} основан на предварительном вычислении некоего среднего поля, созданного всеми частицами, включая данную, и расчете силы на основе этого поля.

            Таким образом, метод \enquote{частица-сетка} позволяет вовлекать в процесс моделирования большее количество частиц.

            Для вычисления суммарного поля можно использовать метод Галеркина. Плотность заряда в $i$-м узле вычисляется как количество частиц, попавших в ячейку Дирихле, связанную с $i$-м узлом, умноженную на заряд одной частицы и деленную на площадь ячейки.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsubsection{Метод конечных элементов}

            Опишем метод конечных элементов в формулировке Галеркина.

            Выберем некоторый функциональный базис $\Phi = \qty{ \phi_i(x,y) \ |\ (x,y) \in D }$. Решение задачи будем искать в классе функций $f_\Phi(x,y)$, порожденных базисом $\Phi$:
            %
            \begin{equation}
                f_{\Phi}(x,y) = \sum\limits_{i\in\Phi} c_i \phi_i .
            \end{equation}

            Таким образом, в \autoref{eq:poisson_eq_dimless} под $\varphi(x,y)$ будем подразумевать $\varphi_\Phi(x,y)$, а под $\rho(x,y)$~--- $\rho_\Phi(x,y)$.

            Согласно Галеркину, неизвестные коэффициенты $c_i$ могут быть найдены следующим путем. Рассмотрим невязку
            %
            \begin{equation}
                R(x,y) = \Delta\varphi(x,y) - \rho(x,y) .
            \end{equation}
            %
            Если $\varphi(x,y)$~--- решение задачи, то невязка $R(x,y) = 0 \ \forall (x,y) \in D$. Поскольку базис $\Phi$ является полным для функций класса $f_\Phi(x,y)$, этому требованию можно удовлетворить, затребовав
            %
            \begin{equation}\label{eq:rdotphi}
                \braket{R}{\phi_i} = 0 \ \forall i \in \Phi ,
            \end{equation}
            %
            где за $\braket{\cdot}$ обозначено скалярное произведение функций на области $D$:
            %
            \begin{equation}
                \braket{f}{g} = \iint\limits_D f(x,y) g(x,y) \dd{S}.
            \end{equation}
            %
            Если теперь раскрыть \autoref{eq:rdotphi} явно, получим
            %
            \begin{equation}\label{eq:sle}
                \sum\limits_{j\in\Phi}
                    c_j \braket{\Delta\phi_j}{\phi_i} -
                        \braket{\rho}{\phi_i} = 0 \ \forall i \in \Phi .
            \end{equation}
            %
            Полученное выражение~--- система линейных уравнений относительно неизвестных $c_j$. Она может быть решена матричными или другими методами решения СЛУ.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsubsection{Кусочно-линейный базис}

            Обычно в качестве базиса $\Phi$ выбирают элементный базис, в котором функции $\phi_i$ равны единице в соответствующих точках $v_i$ и спадают до нуля на границе области $D_i \subset D$, ограниченной соседними треугольниками $t_k \in T_i$ узла $v_i$. Это позволяет легко учитывать граничные условия. Так, граничное условие Дирихле в узле $v_i$ задается через значение коэффициента $c_i$ при члене $\phi_i$ в разложении $\varphi$ по базису $\Phi$.

            При наличии граничных условий Дирихле не все коэффициенты $c_i$ являются неизвестными, поэтому в \autoref{eq:rdotphi} взятие скалярных произведений на базисные функции, соответствующие известным коэффициентам, является излишним.

            Матрица коэффициентов при векторе неизвестных $c_i$ в случае элементного базиса сильно разрежена. В связи с этим не целесообразно применять прямые матричные методы (особенно метод псевдообратной матрицы) для нахождения значений коэффициентов $c_i$. Наиболее оптимальным видится метод Качмаржа, который не требует загрузки в память сразу всей матрицы, а также позволяет оптимизацию структуры матрицы на уровне строк (хранение только ненулевых элементов строки).

            Наиболее простым элементным базисом является кусочно-линейный базис. Базисные функции $\phi_i$ в нем представляют собой пирамидки с вершиной в точке $v_i$, где значение функции $\phi_i(v_i) = 1$. Основание пирамидки~--- область $D_i$, образованная соседними к узлу $v_i$ треугольниками. Вне и на границе области $D_i$ базисная функция $\phi_i$ обращается в нуль.

            В случае элементного базиса \autoref{eq:sle} позволяет дополнительные упрощения. Распишем скалярное произведение $\braket{\Delta\phi_j}{\phi_i}$ по теореме Гаусса:
            %
            \begin{equation}\begin{aligned}
                \braket{\Delta\phi_j}{\phi_i}
                    &= \iint\limits_D \Delta\phi_j \phi_i \dd{S} \\
                    &= \iint\limits_{\partial D} \nabla\phi_j \phi_i \dd{\vb{l}} -
                       \iint\limits_D \nabla\phi_j \nabla\phi_i \dd{S} .
            \end{aligned}\end{equation}
            %
            Предпоследний интеграл обращается в нуль, поскольку $\phi_j(\partial D) = 0$.

            Для кусочно-линейного базиса $\nabla\phi_i = \text{const}$, поэтому последний интеграл сводится к суммированию площадей \enquote{общих} треугольников областей $D_i$ и $D_j$, помноженных на константы.

            При ненулевом $\rho$ возникает также необходимость нахождения $\braket{\rho}{\phi_i}$. Как и раньше, разложим $\rho$ по базису $\Phi$ и рассмотрим скалярные произведения вида $\braket{\phi_j}{\phi_i}$. Интегрирование необходимо проводить по площадям треугольников, общих для областей $D_i$ и $D_j$. Сложность такого интегрирования в явном виде в силу произвольности треугольных областей, несомненно, велика, но ее можно уменьшить, произведя замену системы координат. Само же интегрирование после замены координат не представляет сложности.

            Пусть требуется найти
            %
            \begin{equation}
                \iint\limits_{\bigtriangleup ABC} f(x,y) \dd{S}
            \end{equation}
            %
            и пусть $\vb{a}$, $\vb{b}$ и $\vb{c}$~--- радиусы-векторы точек треугольника $ABC$. Произведем замену координат $(x,y) \mapsto (u,v)$ по правилу:
            %
            \begin{equation}
                (x,y) = \vb{a} + u (\vb{b} - \vb{a}) + v (\vb{c} - \vb{a}) .
            \end{equation}
            %
            Тогда
            %
            \begin{equation}
                \iint\limits_{\bigtriangleup ABC} f(x,y) \dd{S}
                    = \int\limits_0^1 \int\limits_0^{1-u}
                        f(x(u,v),y(u,v)) \qty|J_{xyuv}| \dd{u}\dd{v} ,
            \end{equation}
            %
            где $J_{xyuv} = \qty|\qty[(\vb{b} - \vb{a}) \times (\vb{c} - \vb{a})]| = 2 S_{ABC}$~--- якобиан преобразования координат.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Практическая часть}

        В ходе работы была написана демонстрационная программа (\autoref{fig:mainwindow}) на языке  \enquote{C++}, позволяющая исследовать поведение частиц в электронной лампе и производить построение вольт-амперных характеристик (ВАХ).
        %
        \begin{figure}[h]
            \centering
            \includegraphics[width=0.6\textwidth]{mainwindow}
            \caption[]{Главное окно программы}
            \label{fig:mainwindow}
        \end{figure}

        На \autoref{fig:t} показаны состояния системы в последовательные, но близкие моменты времени. С течением времени частицы движутся от катода к аноду. Видно также, что частицы разлетаются под действием собственного поля: силовые линии поля, создаваемого сетками, почти прямые; суммарное поле частиц вносит в них искажения, вызывая тем самым рассеяние частиц. Чем выше интенсивность эмиссии частиц из катода, тем больше собственное поле частиц и тем сильнее они рассеиваются. Влияние рассеяния можно уменьшить, увеличивая начальную скорость частиц.

        На \autoref{fig:i-va} - \autoref{fig:i-v12} показаны ВАХ лампы в разных режимах работы. Стоит отметить, что в рамках текущей модели невозможно правильно оценить влияние экранирующей сетки на процессы внутри лампы. Сетки моделируются идеальными монолитными проводниками, которые полностью разделяют поле в области до и после сетки (сетки непроницаемы).

        Проанализируем полученные ВАХ. Во-первых, мы наблюдаем эффект гистерезиса. Степень его выраженности варьируется в зависимости от параметров метода снятия ВАХ, а именно от способа измерения тока (\autoref{fig:i-va}). В работе используется метод подсчета количества частиц, дошедших до анода за некоторых промежуток времени. Поскольку частицы имеют случайные начальные параметры, количество таких частиц за один шаг по временной сетке может значительно варьироваться. В целях сглаживания результатов целесообразно выбирать промежуток времени порядка 10-20 шагов по временной сетке. Однако чрезмерное сглаживание сводит на нет наблюдаемость эффекта гистерезиса.

        Во-вторых, на \autoref{fig:i-v12} \subref{fig:i-v1} справа имеется провал ВАХ. Это связано с тем, что экранирующая сетка полагается заземленной, т.е. ее потенциал равен потенциалу катода. При некотором значении потенциала разность потенциалов между заземленной экранирующей сеткой и управляющей сеткой становится достаточной для значительного торможения частиц, ускоренных на участке между катодом и управляющей сеткой. Поэтому на практике на экранирующую сетку иногда подают отличный от катодного потенциал для дополнительного ускорения частиц.

        В-третьих, мы видим, что у анодной ВАХ существует некоторое стационарное значение анодного тока, в то время как у ВАХ управляющей сетки такого значения нет. Связано это с тем, что анод полностью (в реальных лампах~--- почти полностью) изолирован экранирующей сеткой и не оказывает влияния на скапливающиеся у катода частицы. Управляющая же сетка способна ускорять эти частицы, оттягивать их оттуда, направляя к аноду, тем самым увеличивая анодный ток. Рост анодного тока в этом случае ограничен лишь только интенсивностью эмиссии частиц из катода и степенью их отталкивания друг от друга (в этом случае частицы не достигают анода, вылетая за пределы области моделирования).

        Следует отметить также, что в реальных лампах из-за применения экранирующей сетки возможно включение лампы в цепи высокого напряжения с сохранением при этом возможности управления анодным током относительно малым потенциалом управляющей сетки.

        \begin{figure}[!htb]%
            \centering
            %
            \subfloat[][]{%
                \label{fig:t1}%
                \includegraphics[width=0.45\textwidth]{t1}}%
            \hspace{8pt}%
            %
            \subfloat[][]{%
                \label{fig:t2}%
                \includegraphics[width=0.45\textwidth]{t2}}%
            \hspace{8pt}%
            %
            \caption[]{Распределение частиц внутри лампы в близкие моменты времени. Разности потенциалов между соседними сетками постоянны. На \subref{fig:t2} дополнительно показаны эквипотенциальные линии. На \subref{fig:t2} частицы сдвинуты относительно \subref{fig:t1} примерно на 5 условных единиц (примерное расстояние между эквипотенциальными линиями). Заметно искажение эквипотенциальных линий у катода.}%
            \label{fig:t}%
        \end{figure}
        %
        \begin{figure}[!htb]%
            \centering
            %
            \subfloat[][]{%
                \label{fig:i-va2}%
                \includegraphics[width=0.45\textwidth]{i-va2}}%
            \hspace{8pt}%
            %
            \subfloat[][]{%
                \label{fig:i-va3}%
                \includegraphics[width=0.45\textwidth]{i-va3}}%
            \hspace{8pt}%
            %
            \caption[]{Анодные ВАХ (катод и экранирующая сетка заземлены). Зеленым цветом показаны ВАХ при обратном направлении изменения потенциала. Интервал времени замера величины тока \subref{fig:i-va2} нормальный \subref{fig:i-va3} короткий.}%
            \label{fig:i-va}%
        \end{figure}
        %
        \begin{figure}[!htb]%
            \centering
            %
            \subfloat[][]{%
                \label{fig:i-v2}%
                \includegraphics[width=0.45\textwidth]{i-v2}}%
            \hspace{8pt}%
            %
            \subfloat[][]{%
                \label{fig:i-v1}%
                \includegraphics[width=0.45\textwidth]{i-v1}}%
            \hspace{8pt}%
            %
            \caption[]{Сеточные ВАХ: \subref{fig:i-v2} экранирующей \subref{fig:i-v1} управляющей сетки. Зеленым цветом показаны ВАХ при обратном направлении изменения потенциала. В случае \subref{fig:i-v1} экранирующая сетка заземлена.}%
            \label{fig:i-v12}%
        \end{figure}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Заключение}

        В ходе работы была написана демонстрационная программа, позволяющая исследовать ВАХ четырехэлектродной лампы в различных режимах работы.

        При разработке программы были использованы приведенные в работе теоретические выкладки, а также приняты во внимание практические аспекты реализации интерактивной демонстрационной программы.

        Результаты моделирования классических случаев совпадают с ожидаемыми, что говорит о применимости метода частица-сетка к моделированию общих свойств электронных ламп и других простых электронных приборов, основанных на принципах пролетного движения электронов.

\end{document}
